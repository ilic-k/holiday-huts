<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <h2 class="text-center mb-4">Registracija</h2>

      @if (errorMsg) {
        <div class="alert alert-danger">{{ errorMsg }}</div>
      }
      @if (successMsg) {
        <div class="alert alert-success">{{ successMsg }}</div>
      }

      <form (ngSubmit)="onSubmit()" #registerForm="ngForm">
        <!-- Korisničko ime -->
        <div class="mb-3">
          <label for="username" class="form-label">Korisničko ime *</label>
          <input
            type="text"
            class="form-control"
            id="username"
            name="username"
            [(ngModel)]="username"
            required
          />
        </div>

        <!-- Email -->
        <div class="mb-3">
          <label for="email" class="form-label">Email *</label>
          <input
            type="email"
            class="form-control"
            id="email"
            name="email"
            [(ngModel)]="email"
            required
          />
        </div>

        <!-- Lozinka -->
        <div class="mb-3">
          <label for="password" class="form-label">Lozinka *</label>
          <input
            type="password"
            class="form-control"
            id="password"
            name="password"
            [(ngModel)]="password"
            required
          />
          <small class="form-text text-muted">
            Min. 8 karaktera, veliko slovo, malo slovo, broj i specijalan karakter
          </small>
        </div>

        <!-- Potvrda lozinke -->
        <div class="mb-3">
          <label for="confirmPassword" class="form-label">Potvrdi lozinku *</label>
          <input
            type="password"
            class="form-control"
            id="confirmPassword"
            name="confirmPassword"
            [(ngModel)]="confirmPassword"
            required
          />
        </div>

        <!-- Rola -->
        <div class="mb-3">
          <label for="role" class="form-label">Tip korisnika</label>
          <select class="form-select" id="role" name="role" [(ngModel)]="role">
            <option value="turista">Turista</option>
            <option value="vlasnik">Vlasnik vikendice</option>
          </select>
        </div>

        <!-- Ime -->
        <div class="mb-3">
          <label for="name" class="form-label">Ime *</label>
          <input
            type="text"
            class="form-control"
            id="name"
            name="name"
            [(ngModel)]="name"
            required
          />
        </div>

        <!-- Prezime -->
        <div class="mb-3">
          <label for="lastname" class="form-label">Prezime *</label>
          <input
            type="text"
            class="form-control"
            id="lastname"
            name="lastname"
            [(ngModel)]="lastname"
            required
          />
        </div>

        <!-- Pol -->
        <div class="mb-3">
          <label for="gender" class="form-label">Pol *</label>
          <select class="form-select" id="gender" name="gender" [(ngModel)]="gender" required>
            <option value="M">Muški (M)</option>
            <option value="Z">Ženski (Ž)</option>
          </select>
        </div>

        <!-- Adresa -->
        <div class="mb-3">
          <label for="address" class="form-label">Adresa *</label>
          <input
            type="text"
            class="form-control"
            id="address"
            name="address"
            [(ngModel)]="address"
            required
          />
        </div>

        <!-- Telefon -->
        <div class="mb-3">
          <label for="phone" class="form-label">Kontakt telefon *</label>
          <input
            type="tel"
            class="form-control"
            id="phone"
            name="phone"
            [(ngModel)]="phone"
            placeholder="+381 11 123 4567"
            required
          />
        </div>

        <!-- Kreditna kartica -->
        <div class="mb-3">
          <label for="creditCard" class="form-label">Broj kreditne kartice *</label>
          <div class="input-group">
            <input
              type="text"
              class="form-control"
              id="creditCard"
              name="creditCard"
              [(ngModel)]="creditCard"
              (input)="onCreditCardInput()"
              placeholder="300012345678901"
              maxlength="16"
              required
            />
            @if (cardType) {
              <span class="input-group-text card-icon">
                @if (cardType === 'diners') {
                  <img src="/assets/cards/diners.svg" alt="Diners" style="height: 24px;" title="Diners Club" />
                }
                @if (cardType === 'mastercard') {
                  <img src="/assets/cards/mastercard.svg" alt="MasterCard" style="height: 24px;" title="MasterCard" />
                }
                @if (cardType === 'visa') {
                  <img src="/assets/cards/visa.svg" alt="Visa" style="height: 24px;" title="Visa" />
                }
              </span>
            }
          </div>
          <small class="form-text text-muted">
            Podržani tipovi: Diners (15 cifara), MasterCard (16 cifara), Visa (16 cifara)
          </small>
        </div>

        <!-- Profilna slika -->
        <div class="mb-3">
          <label for="image" class="form-label">Profilna slika (opciono)</label>
          <input
            type="file"
            class="form-control"
            id="image"
            name="image"
            accept="image/jpeg,image/jpg,image/png"
            (change)="onFileSelected($event)"
          />
          <small class="form-text text-muted">
            JPG/PNG format, 100x100 px do 300x300 px, max 5MB. Ako ne dodate sliku, dobićete podrazumevanu.
          </small>
        </div>

        <!-- Dugme -->
        <div class="d-grid">
          <button type="submit" class="btn btn-primary" [disabled]="!registerForm.valid">
            Registruj se
          </button>
        </div>

        <div class="text-center mt-3">
          <a routerLink="/login">Već imaš nalog? Prijavi se</a>
        </div>
      </form>
    </div>
  </div>
</div>
